# AI建议功能使用说明

## 功能概述

AI建议功能允许用户根据其MBTI性格类型和个人信息获取个性化的AI建议，涵盖职业发展、投资理财、社交关系、感情关系和个人成长等方面。

## 配置要求

1. **环境变量配置**
   在 `.env.local` 文件中添加：
   ```
   OPENROUTER_API_KEY=your-openrouter-api-key-here
   NEXT_PUBLIC_SITE_URL=http://localhost:3000
   ```

2. **获取OpenRouter API密钥**
   - 访问 https://openrouter.ai/
   - 注册账户并获取API密钥
   - 将密钥添加到环境变量中

## 功能特点

### 1. 用户信息收集
- 年龄
- 性别
- 职业
- 兴趣爱好
- 当前人生目标

### 2. AI建议内容
- **职业发展**: 适合的职业路径、工作环境偏好、领导风格
- **投资理财**: 风险承受能力、投资方法、财务习惯
- **社交关系**: 沟通风格、友谊模式、社交策略
- **感情关系**: 兼容性、沟通需求、关系动态
- **个人成长**: 发展领域、压力管理、生活平衡

### 3. 流式返回
- 实时显示AI生成建议的过程
- 支持Markdown格式渲染
- 流畅的用户体验

### 4. 多语言支持
- 支持所有7种语言：中文、英文、德文、西班牙文、法文、葡萄牙文、俄文
- AI会根据用户当前语言环境返回对应语言的建议

## 使用流程

1. **进入人格详情页**
   - 完成MBTI测试后点击"查看完整档案"
   - 或直接访问 `/[locale]/personality/[type]`

2. **点击"获取AI建议"按钮**
   - 位于人格详情页面的操作按钮区域
   - 紫色渐变按钮，带有灯泡图标

3. **填写个人信息表单**
   - 必填项：年龄、职业
   - 可选项：性别、兴趣爱好、人生目标

4. **获取个性化建议**
   - 点击"获取AI建议"提交表单
   - 实时查看AI生成的建议内容
   - 建议以Markdown格式展示，包含结构化的章节和要点

## 技术实现

### 前端组件
- `AIAdviceModal.tsx`: AI建议弹窗组件
- 集成到 `PersonalityPageContent.tsx` 中

### 后端API
- `/[locale]/api/ai/advice/route.ts`: AI建议API路由
- 支持流式响应
- 连接数据库获取人格描述信息
- 调用OpenRouter的DeepSeek V3.2模型

### 数据流
1. 用户提交个人信息表单
2. 前端发送POST请求到AI建议API
3. 后端从数据库获取英文版人格描述
4. 构建包含用户信息和人格数据的提示词
5. 调用OpenRouter API获取AI建议
6. 流式返回AI生成的建议内容
7. 前端实时渲染Markdown内容

## 隐私保护

- 用户个人信息仅用于AI建议生成，不会存储到数据库
- AI建议会话结束后即丢弃，不保存历史记录
- 遵循应用的隐私保护原则

## 注意事项

1. **API费用**: 使用OpenRouter API会产生费用，请注意控制使用频率
2. **建议仅供参考**: AI建议仅供参考，不应作为专业心理咨询或决策的替代
3. **网络要求**: 需要稳定的网络连接以获得最佳的流式体验
4. **浏览器兼容性**: 需要支持现代JavaScript特性的浏览器

## 故障排除

1. **API密钥错误**: 确保OpenRouter API密钥正确配置
2. **网络连接问题**: 检查网络连接和防火墙设置
3. **翻译缺失**: 确保翻译文件包含所有必要的AI建议相关翻译
4. **流式渲染问题**: 检查浏览器是否支持Server-Sent Events